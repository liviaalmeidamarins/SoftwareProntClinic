<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link rel="icon" href="img/logo-png.png" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <link rel="stylesheet" href="css/style3.css">
</head>
<body>
    <div class="container col-11 col-md-9" id="form-container">
            <div class="logo">
              <img src="img/logo-nome.png" alt="logo">
            </div>
        <div class="row aling-itens-center gx-5">
            <div class="col-md-6 order-md-2">
                <h2>Faça o login para continuar</h2>
                <form method="post" id="loginForm" >
                    <div class="form-floating mb-3">
                        <input type="email" class="form-control" name="email" id="email" placeholder="Digite seu email">
                        <label for="email" class="form-label">Digite seu email</label>
                    </div>
                    <div class="form-floating mb-3">
                        <input type="password" class="form-control" name="senha" id="password" placeholder="Digite sua senha">
                        <label for="password" class="form-label">Digite sua senha</label>
                        <span class="toggle-password" onclick="togglePasswordVisibility()">
                            <i class="fas fa-eye-slash"></i>
                        </span>
                    </div>
                    <input type="submit" class="btn btn-primary" value="Entrar" id="">
                </form>
            </div>
            <div class="col-md-6 order-md-1">
                <div class="col-12">
                    <img src="img/Prototipo.png" alt="entrar no sistema" class="img-fluid">
                </div>
                <div class="col-12" id="link-container">
                    <a href="cadastro.html">Ainda não tenho cadastro</a>
                </div>
            </div>
        </div>
    </div>


    <script src="js/login.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        //AJAX

        document.getElementById('loginForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Impede o envio padrão do formulário
        
        // Recupera os dados do formulário
        const formData = new FormData(this);

        // Envia os dados do formulário para o backend via AJAX
        const xhr = new XMLHttpRequest();
        xhr.open('POST', '../Controller/controllerHome.php'); // URL do script PHP de login
        xhr.onload = function() {
            if (xhr.status === 200) {
                // Se a resposta for bem-sucedida, verifica se o login foi bem-sucedido
                if (xhr.responseText.trim() === 'success') {
                    // Redireciona para a nova página
                    window.location.href = '../View/sistema.html'; // Substitua pela URL da nova página
                } else {
                    // Se o login falhar, exibe uma mensagem de erro
                    alert('Login falhou. Por favor, verifique suas credenciais.');
                }
            } else {
                // Se a requisição falhar, exibe uma mensagem de erro
                alert('Erro ao enviar solicitação. Por favor, tente novamente mais tarde.');
            }
        };
        xhr.onerror = function() {
            // Se houver um erro de rede, exibe uma mensagem de erro
            alert('Erro de rede. Por favor, verifique sua conexão com a internet.');
        };
        xhr.send(formData);
    });
</script>


</body>
</html>